<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>kola\lang\Class.js - kola</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="kola"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 2.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Array.html">Array</a></li>
            
                <li><a href="..&#x2F;classes/Class.html">Class</a></li>
            
                <li><a href="..&#x2F;classes/Function.html">Function</a></li>
            
                <li><a href="..&#x2F;classes/Package.html">Package</a></li>
            
                <li><a href="..&#x2F;classes/String.html">String</a></li>
            
                <li><a href="..&#x2F;classes/window.html">window</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/kola.html">kola</a></li>
            
                <li><a href="..&#x2F;modules/kola.lang.html">kola.lang</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: kola\lang\Class.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * kola language 包，提供JS语言中常见数据类型的常用方法
 * 
 * @module kola.lang
 *&#x2F;

kola(&#x27;kola.lang.Class&#x27;, [
	&#x27;kola.lang.Function&#x27;
], function(KolaFunction) {

	&#x2F;********************************************** 类定义 **********************************************&#x2F;

	&#x2F;**
	 * kola的Class类，用于类的创建和检测等
	 * 
	 * @class Class
	 * @static
	 * 
	 * @author Jady Yang
	 *&#x2F;
	var exports = {

		&#x2F;**
		 * 创建一个新类，并从指定的父类继承，并设置本类的方法
		 * 
		 * @method create
		 * @param [SuperClass] {Function} 父类
		 * @param Methods {Object} 本类的方法列表
		 * @return {Function} 新创建的类
		 *&#x2F;
		create: function(SuperClass, Methods) {
			&#x2F;&#x2F;	判断是否存在要继承的父类
			if ( typeof(Methods) == &#x27;undefined&#x27; ) {
				Methods = SuperClass;
				SuperClass = null;
			}

			var SubClass;

			&#x2F;&#x2F;	判断是否存在方法直接量
			var me = Methods.__ME;
			if ( me ) {
				&#x2F;&#x2F;	存在方法直接量

				&#x2F;&#x2F;	提供能够识别两种调用模式的方法构造体
				SubClass = function() {

					&#x2F;&#x2F;	如果标识符不是数字，那说明类继承体系出现了问题
					var i = this.__I;
					if ( typeof( i ) != &#x27;number&#x27; || i !== 0) {
						&#x2F;&#x2F;	直接调用方式
						return me.apply( SubClass, arguments );
					} else {
						this.constructor = SubClass;
						this.__I = 1;
						&#x2F;&#x2F;	这是类方式
                        
						this._init.apply( this, arguments );

						this.__I = 4;
					}
				};
			} else {
				&#x2F;&#x2F;	创建新类的方法
				SubClass = function() {
					this.constructor = SubClass;
					if (!this._init) {
						this._init = KolaFunction.empty;
					} else {
						this._init.apply( this, arguments );
					}
				};
			}
			
			&#x2F;&#x2F;	给构造函数附加父对象的id
			SubClass._super = SuperClass || null;

			&#x2F;&#x2F;	增加系统标识符
			SubClass.__CLASS = true;		&#x2F;&#x2F;	标识这是个类，但是最终需要替换成类的名称

			var agencyInstance;
			if ( SuperClass == null ) {
				&#x2F;&#x2F;	不存在父类的话
				agencyInstance = Methods;
			} else {
				&#x2F;&#x2F;	存在父类的话，那就创建一个中间的缓冲类
				
				var AgencyClass = function() {};
				AgencyClass.prototype = SuperClass.prototype;
				agencyInstance = new AgencyClass();
				for ( var item in Methods ) {
					agencyInstance[item] = Methods[item];
				}
			}

			&#x2F;&#x2F;	设置类实例标识符
			agencyInstance.__I = 0;

			SubClass.prototype = agencyInstance;		&#x2F;&#x2F;	设置新类的原型

            &#x2F;&#x2F; 拷贝类的静态方法（只有被记录在案的）
            if(SuperClass &amp;&amp; SuperClass.__GENE){
                for(var i=0,il=SuperClass.__GENE.length;i&lt;il;i++){
                    SubClass[SuperClass.__GENE[i]]=SuperClass[SuperClass.__GENE[i]]
                }
            }

			return SubClass;
		},

		&#x2F;**
		 * 判断一个实例是否是某个类型
		 * 
		 * @method isInstanceOf
		 * @param object {Any} 要检测的对象
		 * @param type {String} 类型全名
		 * @return {Boolean} 
		 *&#x2F;
		isInstanceOf: function(object, type) {

			&#x2F;&#x2F;	如果不存在要检测的实例，需要报错
			if ( !object ) {
				if (window.Error) {
					throw new Error( &#x27;要检测的实例不存在&#x27; );
				} else {
					alert(&#x27;要检测的实例不存在&#x27;);
				}
				
				return;
			}

			&#x2F;&#x2F;	判断要检测的示例是否存在构造器，不存在的话直接返回false
			var constructor = object.constructor, className;
			while ( constructor ) {

				&#x2F;&#x2F;	如果构造器的原型中存在__CLASS属性，并且是我们要检测的类型，那就返回true
				if ( typeof( className = constructor.__CLASS) == &#x27;string&#x27; &amp;&amp; className === type ) return true;

				&#x2F;&#x2F;	找到父类，继续判断
				constructor = constructor._super;
			}

			&#x2F;&#x2F;	执行到这里，表明该实例不是指定的类型的实例
			return false;
		},
		
		&#x2F;&#x2F;	FIXME: 需要确定是否保留？与create的区别是什么？
        &#x2F;**
            通过修改原型链方式实现继承
            origClass：构造函数
            protoObject：原型
            protoLink：原型继承
            
            与class.create相比，对debug友好
        *&#x2F;
        buildProto:function(origClass,protoObject,protoLink){
            var agencyObject;
            if ( protoLink == null ) {
                agencyObject = protoObject;
            } else {
                var AgencyClass = function() {};
                AgencyClass.prototype = protoLink.prototype;
                agencyObject = new AgencyClass();
                for ( var item in protoObject ) {
                    agencyObject[item] = protoObject[item];
                }
            }
            origClass.prototype = agencyObject;
            origClass.prototype.base = protoLink;
            origClass.prototype.constructor = origClass;
        }
	};
	
	return exports;
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
